<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>{'date': '2025-12-13 18:01:52', 'analyst': 'Live Demo', 'case_id': 'TOR-1765629112'}</title>
  <script src="https://cdn.jsdelivr.net/npm/echarts@5/dist/echarts.min.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { 
      font-family: 'Times New Roman', serif; 
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%); 
      color: #222; 
      line-height: 1.8;
    }
    .container { 
      max-width: 1200px; 
      margin: 30px auto; 
      background: white; 
      border-radius: 12px; 
      box-shadow: 0 8px 32px rgba(0,0,0,0.1); 
      padding: 48px;
      page-break-after: always;
    }
    .header {
      border-bottom: 4px solid #2a3a5e;
      margin-bottom: 32px;
      padding-bottom: 24px;
      text-align: center;
    }
    h1 { 
      color: #2a3a5e; 
      font-size: 2.5em; 
      margin-bottom: 8px;
      text-transform: uppercase;
      letter-spacing: 2px;
    }
    .subtitle { 
      color: #666; 
      font-size: 1.1em; 
      font-weight: bold;
      margin-bottom: 16px;
    }
    .meta-info {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 16px;
      margin-top: 16px;
      padding-top: 16px;
      border-top: 1px solid #ddd;
    }
    .meta-item {
      background: #f9f9f9;
      padding: 12px;
      border-left: 4px solid #1aaf5d;
      border-radius: 4px;
    }
    .meta-label { font-weight: bold; color: #2a3a5e; }
    .meta-value { color: #666; font-family: 'Courier New', monospace; font-size: 0.95em; }
    .section { 
      margin-bottom: 32px; 
      page-break-inside: avoid;
    }
    .section-title { 
      color: #2a3a5e; 
      font-size: 1.6em;
      border-bottom: 3px solid #1aaf5d;
      padding-bottom: 12px;
      margin-bottom: 16px;
      page-break-after: avoid;
    }
    .alert-box {
      background: linear-gradient(135deg, #fff5f5 0%, #ffe3e3 100%);
      border-left: 5px solid #eb3b5a;
      padding: 16px;
      margin-bottom: 12px;
      border-radius: 4px;
    }
    .alert-critical { border-left-color: #eb3b5a; background: linear-gradient(135deg, #fff5f5 0%, #ffe3e3 100%); }
    .alert-warning { border-left-color: #f7b731; background: linear-gradient(135deg, #fffbf0 0%, #ffe8c3 100%); }
    .alert-info { border-left-color: #2a3a5e; background: linear-gradient(135deg, #f0f3f7 0%, #d4dce5 100%); }
    .alert-label { font-weight: bold; color: #222; margin-bottom: 4px; }
    .alert-text { color: #555; font-size: 0.95em; }
    table { 
      border-collapse: collapse; 
      width: 100%; 
      margin-bottom: 24px;
      font-size: 0.95em;
    }
    th { 
      background: linear-gradient(135deg, #2a3a5e 0%, #3d5a80 100%); 
      color: white;
      padding: 12px;
      text-align: left;
      font-weight: bold;
      border: 1px solid #1a2a3e;
    }
    td { 
      border: 1px solid #ddd; 
      padding: 10px;
      background: #fafafa;
    }
    tr:nth-child(even) td { background: #f0f0f0; }
    tr:hover td { background: #e8f4f8; }
    .confidence-high { color: #1aaf5d; font-weight: bold; }
    .confidence-med { color: #f7b731; font-weight: bold; }
    .confidence-low { color: #eb3b5a; font-weight: bold; }
    .chart-container {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
      gap: 24px;
      margin: 24px 0;
    }
    .chart-box { 
      height: 350px; 
      background: #fafafa; 
      border-radius: 8px; 
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
      border: 1px solid #e0e0e0;
      page-break-inside: avoid;
    }
    .summary-box {
      background: linear-gradient(135deg, #e8f5e9 0%, #c8e6c9 100%);
      padding: 20px;
      border-radius: 8px;
      margin-bottom: 24px;
      border-left: 5px solid #1aaf5d;
    }
    .summary-text { color: #1b5e20; line-height: 1.8; }
    .findings-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 16px;
      margin-bottom: 24px;
    }
    .finding-card {
      background: #f5f5f5;
      padding: 16px;
      border-radius: 8px;
      border-left: 4px solid #2a3a5e;
    }
    .finding-title { font-weight: bold; color: #2a3a5e; margin-bottom: 8px; }
    .finding-value { font-size: 1.5em; color: #1aaf5d; font-weight: bold; }
    .footer {
      margin-top: 40px;
      padding-top: 20px;
      border-top: 1px solid #ddd;
      text-align: center;
      font-size: 0.85em;
      color: #999;
    }
    .btn { 
      background: #2a3a5e; 
      color: white; 
      border: none; 
      padding: 10px 20px; 
      border-radius: 6px; 
      cursor: pointer; 
      margin: 8px 8px 8px 0;
      font-size: 0.95em;
      transition: all 0.3s ease;
    }
    .btn:hover { background: #1aaf5d; transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.15); }
    .controls { margin-bottom: 24px; text-align: center; }
    @media print {
      body { background: white; }
      .container { margin: 0; padding: 20px; box-shadow: none; }
      .controls { display: none; }
      .page-break { page-break-before: always; }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Header Section -->
    <div class="header">
      <h1>{'date': '2025-12-13 18:01:52', 'analyst': 'Live Demo', 'case_id': 'TOR-1765629112'}</h1>
      <div class="subtitle">Forensic Analysis & Correlation Report</div>
      <div class="meta-info">
        <div class="meta-item">
          <div class="meta-label">Generated</div>
          <div class="meta-value">2025-12-13 18:02:09 UTC</div>
        </div>
        <div class="meta-item">
          <div class="meta-label">Analysis System</div>
          <div class="meta-value">TOR Unveil v2.1</div>
        </div>
        <div class="meta-item">
          <div class="meta-label">Classification</div>
          <div class="meta-value">Law Enforcement Sensitive</div>
        </div>
        <div class="meta-item">
          <div class="meta-label">Report ID</div>
          <div class="meta-value">RPT-1765629129</div>
        </div>
      </div>
    </div>

    <!-- Packet Capture Summary -->
    <div class="section">
      <div class="section-title">Packet Capture Summary</div>
      
        <p style="color:#666; padding:16px; background:#f9f9f9; border-radius:4px;">No live packet capture data available.</p>
      
    </div>

    <!-- PCAP Analysis Summary -->
    <div class="section">
      <div class="section-title">PCAP Analysis Summary</div>
      
        <p style="color:#666; padding:16px; background:#f9f9f9; border-radius:4px;">No PCAP analysis results available.</p>
      
    </div>
    <!-- Controls -->
    <div class="controls">
      <button class="btn" onclick="window.print()">üñ®Ô∏è Print Report</button>
      <button class="btn" onclick="downloadReport()">‚¨áÔ∏è Download HTML</button>
      <button class="btn" onclick="window.close()">‚úï Close</button>
    </div>

    <!-- Executive Summary -->
    <div class="section">
      <div class="section-title">Executive Summary</div>
      <div class="summary-box">
        <div class="summary-text">
          <strong>{'description': 'Live forensic report generated from active Tor circuits and relays.'}</strong> This comprehensive forensic analysis examined TOR network activity, circuit patterns, 
          and relay correlations to identify potential entry-exit node relationships and network anomalies. 
          The report includes detailed findings, threat intelligence integration, bandwidth analysis, and 
          timeline reconstruction for legal proceedings and incident response.
        </div>
      </div>
    </div>

    <!-- Key Metrics -->
    <div class="section">
      <div class="section-title">Key Metrics & Findings</div>
      <div class="findings-grid">
        <div class="finding-card">
          <div class="finding-title">Circuits Analyzed</div>
          <div class="finding-value">11</div>
        </div>
        <div class="finding-card">
          <div class="finding-title">Relays Examined</div>
          <div class="finding-value">33</div>
        </div>
        <div class="finding-card">
          <div class="finding-title">Correlations Found</div>
          <div class="finding-value">11</div>
        </div>
        <div class="finding-card">
          <div class="finding-title">Critical Alerts</div>
          <div class="finding-value">0</div>
        </div>
      </div>
    </div>

    <!-- Alerts & Anomalies -->
    <div class="section">
      <div class="section-title">Alerts & Anomalies</div>
      
        
          <div class="alert-box alert-warning">
            <div class="alert-label">[WARNING] RELAY</div>
            <div class="alert-text">Relay fingerprint E09E1A570E7266E9DED42714F27D3D945D9B4EF4 appears in multiple circuits.</div>
          </div>
        
          <div class="alert-box alert-warning">
            <div class="alert-label">[WARNING] RELAY</div>
            <div class="alert-text">Relay fingerprint FC775F7C3B031F8BD21AD814C2F168D402664E4B appears in multiple circuits.</div>
          </div>
        
          <div class="alert-box alert-warning">
            <div class="alert-label">[WARNING] RELAY</div>
            <div class="alert-text">Relay fingerprint 87E79F4B6F9C321B5110F4C0C63DA1853CAF4732 appears in multiple circuits.</div>
          </div>
        
          <div class="alert-box alert-warning">
            <div class="alert-label">[WARNING] RELAY</div>
            <div class="alert-text">Relay fingerprint 87E79F4B6F9C321B5110F4C0C63DA1853CAF4732 appears in multiple circuits.</div>
          </div>
        
          <div class="alert-box alert-warning">
            <div class="alert-label">[WARNING] RELAY</div>
            <div class="alert-text">Relay fingerprint E09E1A570E7266E9DED42714F27D3D945D9B4EF4 appears in multiple circuits.</div>
          </div>
        
          <div class="alert-box alert-warning">
            <div class="alert-label">[WARNING] RELAY</div>
            <div class="alert-text">Relay fingerprint 53B1C6E35706C9EC30B9468B61DFBB67F29BFC2F appears in multiple circuits.</div>
          </div>
        
          <div class="alert-box alert-warning">
            <div class="alert-label">[WARNING] RELAY</div>
            <div class="alert-text">Relay fingerprint 87E79F4B6F9C321B5110F4C0C63DA1853CAF4732 appears in multiple circuits.</div>
          </div>
        
          <div class="alert-box alert-warning">
            <div class="alert-label">[WARNING] RELAY</div>
            <div class="alert-text">Relay fingerprint E09E1A570E7266E9DED42714F27D3D945D9B4EF4 appears in multiple circuits.</div>
          </div>
        
          <div class="alert-box alert-warning">
            <div class="alert-label">[WARNING] RELAY</div>
            <div class="alert-text">Relay fingerprint CD685F61CDDAF92EA1944DC8ACDCD2E2AA7A8AC2 appears in multiple circuits.</div>
          </div>
        
          <div class="alert-box alert-warning">
            <div class="alert-label">[WARNING] RELAY</div>
            <div class="alert-text">Relay fingerprint 87E79F4B6F9C321B5110F4C0C63DA1853CAF4732 appears in multiple circuits.</div>
          </div>
        
          <div class="alert-box alert-warning">
            <div class="alert-label">[WARNING] RELAY</div>
            <div class="alert-text">Relay fingerprint 87E79F4B6F9C321B5110F4C0C63DA1853CAF4732 appears in multiple circuits.</div>
          </div>
        
          <div class="alert-box alert-warning">
            <div class="alert-label">[WARNING] RELAY</div>
            <div class="alert-text">Relay fingerprint E09E1A570E7266E9DED42714F27D3D945D9B4EF4 appears in multiple circuits.</div>
          </div>
        
          <div class="alert-box alert-warning">
            <div class="alert-label">[WARNING] RELAY</div>
            <div class="alert-text">Relay fingerprint D932D7D57C216AF2DE235FC69FBBCDFE116F56B9 appears in multiple circuits.</div>
          </div>
        
          <div class="alert-box alert-warning">
            <div class="alert-label">[WARNING] RELAY</div>
            <div class="alert-text">Relay fingerprint C6AA05B1D6D2ADFD95C141A0243877D045B0BE0D appears in multiple circuits.</div>
          </div>
        
      
    </div>

    <!-- Circuits Analysis -->
    <div class="section">
      <div class="section-title">Circuit Analysis</div>
      
        <table>
          <thead>
            <tr>
              <th>Circuit ID</th>
              <th>Purpose</th>
              <th>Status</th>
              <th>Path Length</th>
              <th>Entry Node</th>
              <th>Exit Node</th>
            </tr>
          </thead>
          <tbody>
            
              <tr>
                <td style="font-family: monospace; font-size: 0.9em;">22</td>
                <td>HS_VANGUARDS</td>
                <td>BUILT</td>
                <td style="text-align: center;">3</td>
                <td style="font-family: monospace; font-size: 0.85em;">E09E1A570E7266E9...</td>
                <td style="font-family: monospace; font-size: 0.85em;">8D41994D1D18E944...</td>
              </tr>
            
              <tr>
                <td style="font-family: monospace; font-size: 0.9em;">21</td>
                <td>HS_VANGUARDS</td>
                <td>BUILT</td>
                <td style="text-align: center;">3</td>
                <td style="font-family: monospace; font-size: 0.85em;">87E79F4B6F9C321B...</td>
                <td style="font-family: monospace; font-size: 0.85em;">CC701FCE86D6AF95...</td>
              </tr>
            
              <tr>
                <td style="font-family: monospace; font-size: 0.9em;">23</td>
                <td>HS_VANGUARDS</td>
                <td>BUILT</td>
                <td style="text-align: center;">3</td>
                <td style="font-family: monospace; font-size: 0.85em;">E09E1A570E7266E9...</td>
                <td style="font-family: monospace; font-size: 0.85em;">D932D7D57C216AF2...</td>
              </tr>
            
              <tr>
                <td style="font-family: monospace; font-size: 0.9em;">20</td>
                <td>CONFLUX_LINKED</td>
                <td>BUILT</td>
                <td style="text-align: center;">3</td>
                <td style="font-family: monospace; font-size: 0.85em;">87E79F4B6F9C321B...</td>
                <td style="font-family: monospace; font-size: 0.85em;">C6AA05B1D6D2ADFD...</td>
              </tr>
            
              <tr>
                <td style="font-family: monospace; font-size: 0.9em;">14</td>
                <td>CONFLUX_LINKED</td>
                <td>BUILT</td>
                <td style="text-align: center;">3</td>
                <td style="font-family: monospace; font-size: 0.85em;">87E79F4B6F9C321B...</td>
                <td style="font-family: monospace; font-size: 0.85em;">53B1C6E35706C9EC...</td>
              </tr>
            
              <tr>
                <td style="font-family: monospace; font-size: 0.9em;">6</td>
                <td>CONFLUX_LINKED</td>
                <td>BUILT</td>
                <td style="text-align: center;">3</td>
                <td style="font-family: monospace; font-size: 0.85em;">E09E1A570E7266E9...</td>
                <td style="font-family: monospace; font-size: 0.85em;">53B1C6E35706C9EC...</td>
              </tr>
            
              <tr>
                <td style="font-family: monospace; font-size: 0.9em;">13</td>
                <td>CONFLUX_LINKED</td>
                <td>BUILT</td>
                <td style="text-align: center;">3</td>
                <td style="font-family: monospace; font-size: 0.85em;">87E79F4B6F9C321B...</td>
                <td style="font-family: monospace; font-size: 0.85em;">CD685F61CDDAF92E...</td>
              </tr>
            
              <tr>
                <td style="font-family: monospace; font-size: 0.9em;">15</td>
                <td>CONFLUX_LINKED</td>
                <td>BUILT</td>
                <td style="text-align: center;">3</td>
                <td style="font-family: monospace; font-size: 0.85em;">E09E1A570E7266E9...</td>
                <td style="font-family: monospace; font-size: 0.85em;">CD685F61CDDAF92E...</td>
              </tr>
            
              <tr>
                <td style="font-family: monospace; font-size: 0.9em;">9</td>
                <td>GENERAL</td>
                <td>BUILT</td>
                <td style="text-align: center;">3</td>
                <td style="font-family: monospace; font-size: 0.85em;">87E79F4B6F9C321B...</td>
                <td style="font-family: monospace; font-size: 0.85em;">A725CD7DB5F9B572...</td>
              </tr>
            
              <tr>
                <td style="font-family: monospace; font-size: 0.9em;">10</td>
                <td>GENERAL</td>
                <td>BUILT</td>
                <td style="text-align: center;">3</td>
                <td style="font-family: monospace; font-size: 0.85em;">87E79F4B6F9C321B...</td>
                <td style="font-family: monospace; font-size: 0.85em;">63F7457B4787B7D8...</td>
              </tr>
            
              <tr>
                <td style="font-family: monospace; font-size: 0.9em;">19</td>
                <td>CONFLUX_LINKED</td>
                <td>BUILT</td>
                <td style="text-align: center;">3</td>
                <td style="font-family: monospace; font-size: 0.85em;">E09E1A570E7266E9...</td>
                <td style="font-family: monospace; font-size: 0.85em;">C6AA05B1D6D2ADFD...</td>
              </tr>
            
          </tbody>
        </table>
        
      
    </div>

    <!-- Correlation Results -->
    <div class="section">
      <div class="section-title">Entry-Exit Correlations</div>
      
        <table>
          <thead>
            <tr>
              <th>Exit Node (Fingerprint)</th>
              <th>Entry Node (Fingerprint)</th>
              <th>Observations</th>
              <th>Confidence Level</th>
            </tr>
          </thead>
          <tbody>
            
              <tr>
                <td style="font-family: monospace; font-size: 0.85em;">8D41994D1D18E94403C3...</td>
                <td style="font-family: monospace; font-size: 0.85em;">E09E1A570E7266E9DED4...</td>
                <td style="text-align: center;">1</td>
                <td style="text-align: center;">
                  
                    <span class="confidence-high">100%</span>
                  
                </td>
              </tr>
            
              <tr>
                <td style="font-family: monospace; font-size: 0.85em;">CC701FCE86D6AF95FC3D...</td>
                <td style="font-family: monospace; font-size: 0.85em;">87E79F4B6F9C321B5110...</td>
                <td style="text-align: center;">1</td>
                <td style="text-align: center;">
                  
                    <span class="confidence-high">100%</span>
                  
                </td>
              </tr>
            
              <tr>
                <td style="font-family: monospace; font-size: 0.85em;">D932D7D57C216AF2DE23...</td>
                <td style="font-family: monospace; font-size: 0.85em;">E09E1A570E7266E9DED4...</td>
                <td style="text-align: center;">1</td>
                <td style="text-align: center;">
                  
                    <span class="confidence-high">100%</span>
                  
                </td>
              </tr>
            
              <tr>
                <td style="font-family: monospace; font-size: 0.85em;">C6AA05B1D6D2ADFD95C1...</td>
                <td style="font-family: monospace; font-size: 0.85em;">87E79F4B6F9C321B5110...</td>
                <td style="text-align: center;">1</td>
                <td style="text-align: center;">
                  
                    <span class="confidence-high">100%</span>
                  
                </td>
              </tr>
            
              <tr>
                <td style="font-family: monospace; font-size: 0.85em;">53B1C6E35706C9EC30B9...</td>
                <td style="font-family: monospace; font-size: 0.85em;">87E79F4B6F9C321B5110...</td>
                <td style="text-align: center;">1</td>
                <td style="text-align: center;">
                  
                    <span class="confidence-high">100%</span>
                  
                </td>
              </tr>
            
              <tr>
                <td style="font-family: monospace; font-size: 0.85em;">53B1C6E35706C9EC30B9...</td>
                <td style="font-family: monospace; font-size: 0.85em;">E09E1A570E7266E9DED4...</td>
                <td style="text-align: center;">1</td>
                <td style="text-align: center;">
                  
                    <span class="confidence-high">100%</span>
                  
                </td>
              </tr>
            
              <tr>
                <td style="font-family: monospace; font-size: 0.85em;">CD685F61CDDAF92EA194...</td>
                <td style="font-family: monospace; font-size: 0.85em;">87E79F4B6F9C321B5110...</td>
                <td style="text-align: center;">1</td>
                <td style="text-align: center;">
                  
                    <span class="confidence-high">100%</span>
                  
                </td>
              </tr>
            
              <tr>
                <td style="font-family: monospace; font-size: 0.85em;">CD685F61CDDAF92EA194...</td>
                <td style="font-family: monospace; font-size: 0.85em;">E09E1A570E7266E9DED4...</td>
                <td style="text-align: center;">1</td>
                <td style="text-align: center;">
                  
                    <span class="confidence-high">100%</span>
                  
                </td>
              </tr>
            
              <tr>
                <td style="font-family: monospace; font-size: 0.85em;">A725CD7DB5F9B5723E76...</td>
                <td style="font-family: monospace; font-size: 0.85em;">87E79F4B6F9C321B5110...</td>
                <td style="text-align: center;">1</td>
                <td style="text-align: center;">
                  
                    <span class="confidence-high">100%</span>
                  
                </td>
              </tr>
            
              <tr>
                <td style="font-family: monospace; font-size: 0.85em;">63F7457B4787B7D80B89...</td>
                <td style="font-family: monospace; font-size: 0.85em;">87E79F4B6F9C321B5110...</td>
                <td style="text-align: center;">1</td>
                <td style="text-align: center;">
                  
                    <span class="confidence-high">100%</span>
                  
                </td>
              </tr>
            
              <tr>
                <td style="font-family: monospace; font-size: 0.85em;">C6AA05B1D6D2ADFD95C1...</td>
                <td style="font-family: monospace; font-size: 0.85em;">E09E1A570E7266E9DED4...</td>
                <td style="text-align: center;">1</td>
                <td style="text-align: center;">
                  
                    <span class="confidence-high">100%</span>
                  
                </td>
              </tr>
            
          </tbody>
        </table>
        
      
    </div>

    <!-- Charts Section -->
    <div class="section page-break">
      <div class="section-title">Network Analysis Visualizations</div>
      <div class="chart-container">
        <div id="bandwidthChart" class="chart-box"></div>
        <div id="confidenceChart" class="chart-box"></div>
      </div>
    </div>

    <!-- Conclusions -->
    <div class="section">
      <div class="section-title">Conclusions & Recommendations</div>
      <div style="background: #f5f5f5; padding: 16px; border-radius: 8px; line-height: 1.8;">
        <p>This forensic analysis of TOR network activity has identified 11 significant entry-exit node correlations 
        and 0 critical security anomalies requiring immediate attention.</p>
        
        <p style="margin-top: 12px;"><strong>Recommended Actions:</strong></p>
        <ul style="margin-left: 20px; margin-top: 8px;">
          <li>Continue monitoring identified high-confidence correlations for behavioral patterns</li>
          <li>Cross-reference critical alerts with external threat intelligence feeds</li>
          <li>Implement enhanced logging for identified exit nodes and circuits</li>
          <li>Coordinate with ISP/network providers for additional context on flagged addresses</li>
          <li>Archive this report and related evidence for legal proceedings if warranted</li>
        </ul>
      </div>
    </div>

    <!-- Footer -->
    <div class="footer">
      <p><strong>TOR Unveil Forensic Analysis System v2.1</strong></p>
      <p>For Law Enforcement & Cybersecurity Professional Use Only | Classified Information</p>
      <p>2025-12-13 18:02:09 UTC | Report ID: RPT-1765629129</p>
    </div>
  </div>

  <script>
    // Bandwidth Chart
    const bandwidthChart = echarts.init(document.getElementById('bandwidthChart'));
    const relays = JSON.parse(`[{"a": "185.80.30.102", "bw": 82585712, "c": "cz", "lat": null, "lon": null, "n": "Tor0x800"}, {"a": "89.47.50.223", "bw": 58730936, "c": "ch", "lat": null, "lon": null, "n": "vpskilobug"}, {"a": "195.201.174.108", "bw": 63141888, "c": "de", "lat": null, "lon": null, "n": "psYchotic"}, {"a": "94.23.170.63", "bw": 39247095, "c": "cz", "lat": null, "lon": null, "n": "guano"}, {"a": "212.227.197.40", "bw": 24958962, "c": "de", "lat": null, "lon": null, "n": "4713"}, {"a": "157.90.183.103", "bw": 65536000, "c": "de", "lat": null, "lon": null, "n": "sutsuj"}, {"a": "185.80.30.102", "bw": 82585712, "c": "cz", "lat": null, "lon": null, "n": "Tor0x800"}, {"a": "212.227.197.40", "bw": 24958962, "c": "de", "lat": null, "lon": null, "n": "4713"}, {"a": "57.129.74.228", "bw": 42042732, "c": "de", "lat": null, "lon": null, "n": "MartinoRelay"}, {"a": "94.23.170.63", "bw": 39247095, "c": "cz", "lat": null, "lon": null, "n": "guano"}, {"a": "185.130.47.76", "bw": 20971520, "c": "nl", "lat": null, "lon": null, "n": "pyramid333"}, {"a": "192.42.116.184", "bw": 20653590, "c": "nl", "lat": null, "lon": null, "n": "NTH32R6"}, {"a": "94.23.170.63", "bw": 39247095, "c": "cz", "lat": null, "lon": null, "n": "guano"}, {"a": "195.201.18.168", "bw": 10240000, "c": "de", "lat": null, "lon": null, "n": "caelivinculum"}, {"a": "109.70.100.3", "bw": 37037265, "c": "at", "lat": null, "lon": null, "n": "kuerbis"}, {"a": "185.80.30.102", "bw": 82585712, "c": "cz", "lat": null, "lon": null, "n": "Tor0x800"}, {"a": "94.23.121.150", "bw": 53528930, "c": "gb", "lat": null, "lon": null, "n": "Unnamed"}, {"a": "109.70.100.3", "bw": 37037265, "c": "at", "lat": null, "lon": null, "n": "kuerbis"}, {"a": "94.23.170.63", "bw": 39247095, "c": "cz", "lat": null, "lon": null, "n": "guano"}, {"a": "217.79.181.76", "bw": 39162832, "c": "de", "lat": null, "lon": null, "n": "ForPrivacyNET"}, {"a": "109.70.100.5", "bw": 29007046, "c": "at", "lat": null, "lon": null, "n": "erdbeeren"}, {"a": "185.80.30.102", "bw": 82585712, "c": "cz", "lat": null, "lon": null, "n": "Tor0x800"}, {"a": "145.239.81.58", "bw": 10485760, "c": "pl", "lat": null, "lon": null, "n": "0x4242"}, {"a": "109.70.100.5", "bw": 29007046, "c": "at", "lat": null, "lon": null, "n": "erdbeeren"}, {"a": "94.23.170.63", "bw": 39247095, "c": "cz", "lat": null, "lon": null, "n": "guano"}, {"a": "176.65.149.27", "bw": 51439164, "c": "nl", "lat": null, "lon": null, "n": "CypherpunkLabsExit"}, {"a": "193.26.115.123", "bw": 12110909, "c": "us", "lat": null, "lon": null, "n": "Quetzalcoatl"}, {"a": "94.23.170.63", "bw": 39247095, "c": "cz", "lat": null, "lon": null, "n": "guano"}, {"a": "45.140.165.138", "bw": 14950400, "c": "fr", "lat": null, "lon": null, "n": "Esquie"}, {"a": "185.220.101.19", "bw": 33354244, "c": "de", "lat": null, "lon": null, "n": "artikel10ber73"}, {"a": "185.80.30.102", "bw": 82585712, "c": "cz", "lat": null, "lon": null, "n": "Tor0x800"}, {"a": "57.129.74.228", "bw": 42042732, "c": "de", "lat": null, "lon": null, "n": "MartinoRelay"}, {"a": "192.42.116.184", "bw": 20653590, "c": "nl", "lat": null, "lon": null, "n": "NTH32R6"}]`);
    const topRelays = relays.slice(0, 10);
    bandwidthChart.setOption({
      title: { text: 'Top Relays by Bandwidth', left: 'center', textStyle: { fontSize: 12, fontWeight: 'bold' } },
      tooltip: { trigger: 'axis' },
      xAxis: { type: 'category', data: topRelays.map(r => r.n || r.nickname || '?').slice(0, 8), axisLabel: { rotate: 45, fontSize: 9 } },
      yAxis: { type: 'value' },
      series: [{
        type: 'bar',
        data: topRelays.map(r => r.bw || r.advertised_bandwidth || 0).slice(0, 8),
        itemStyle: { color: '#1aaf5d' }
      }]
    });

    // Confidence Chart
    const confidenceChart = echarts.init(document.getElementById('confidenceChart'));
    const correlations = JSON.parse(`[{"confidence": 1.0, "entry": "E09E1A570E7266E9DED42714F27D3D945D9B4EF4", "exit": "8D41994D1D18E94403C3F67D0699E4C9D2248D4A"}, {"confidence": 1.0, "entry": "87E79F4B6F9C321B5110F4C0C63DA1853CAF4732", "exit": "CC701FCE86D6AF95FC3D5B71645D3430794910C1"}, {"confidence": 1.0, "entry": "E09E1A570E7266E9DED42714F27D3D945D9B4EF4", "exit": "D932D7D57C216AF2DE235FC69FBBCDFE116F56B9"}, {"confidence": 1.0, "entry": "87E79F4B6F9C321B5110F4C0C63DA1853CAF4732", "exit": "C6AA05B1D6D2ADFD95C141A0243877D045B0BE0D"}, {"confidence": 1.0, "entry": "87E79F4B6F9C321B5110F4C0C63DA1853CAF4732", "exit": "53B1C6E35706C9EC30B9468B61DFBB67F29BFC2F"}, {"confidence": 1.0, "entry": "E09E1A570E7266E9DED42714F27D3D945D9B4EF4", "exit": "53B1C6E35706C9EC30B9468B61DFBB67F29BFC2F"}, {"confidence": 1.0, "entry": "87E79F4B6F9C321B5110F4C0C63DA1853CAF4732", "exit": "CD685F61CDDAF92EA1944DC8ACDCD2E2AA7A8AC2"}, {"confidence": 1.0, "entry": "E09E1A570E7266E9DED42714F27D3D945D9B4EF4", "exit": "CD685F61CDDAF92EA1944DC8ACDCD2E2AA7A8AC2"}, {"confidence": 1.0, "entry": "87E79F4B6F9C321B5110F4C0C63DA1853CAF4732", "exit": "A725CD7DB5F9B5723E764C0FF419E56AD66D81AC"}, {"confidence": 1.0, "entry": "87E79F4B6F9C321B5110F4C0C63DA1853CAF4732", "exit": "63F7457B4787B7D80B897EF06F838E7A1FDEB311"}, {"confidence": 1.0, "entry": "E09E1A570E7266E9DED42714F27D3D945D9B4EF4", "exit": "C6AA05B1D6D2ADFD95C141A0243877D045B0BE0D"}]`);
    const topCorrs = correlations.slice(0, 10);
    confidenceChart.setOption({
      title: { text: 'Correlation Confidence Levels', left: 'center', textStyle: { fontSize: 12, fontWeight: 'bold' } },
      tooltip: { trigger: 'axis' },
      xAxis: { type: 'category', data: topCorrs.map((_, i) => 'Corr ' + (i + 1)), axisLabel: { fontSize: 9 } },
      yAxis: { type: 'value', min: 0, max: 1 },
      series: [{
        type: 'line',
        data: topCorrs.map(c => c.confidence || 0),
        smooth: true,
        itemStyle: { color: '#2a3a5e' },
        areaStyle: { color: 'rgba(42, 58, 94, 0.2)' }
      }]
    });

    function downloadReport() {
      const html = document.documentElement.outerHTML;
      const blob = new Blob([html], { type: 'text/html; charset=utf-8' });
      const url = URL.createObjectURL(blob);
      const link = document.createElement('a');
      link.href = url;
      link.download = 'TOR_Forensic_Report_1765629129.html';
      link.click();
      URL.revokeObjectURL(url);
    }

    // PCAP Flows Chart
    try {
    const pcapAnalysis = JSON.parse(`{}`);
      if (pcapAnalysis && pcapAnalysis.flows) {
        const entries = Object.entries(pcapAnalysis.flows).slice(0, 12);
        const chart = echarts.init(document.getElementById('pcapFlowsChart'));
        chart.setOption({
          title: { text: 'Top PCAP Flows', left: 'center', textStyle: { fontSize: 12, fontWeight: 'bold' } },
          tooltip: { trigger: 'axis' },
          xAxis: { type: 'category', data: entries.map(e => e[0]), axisLabel: { rotate: 30, fontSize: 9 } },
          yAxis: { type: 'value' },
          series: [{ type: 'bar', data: entries.map(e => e[1]), itemStyle: { color: '#ff8c00' } }]
        });
      }
    } catch (e) {}
  </script>
</body>
</html>